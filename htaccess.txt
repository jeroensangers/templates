# Apache configuration file
# httpd.apache.org/docs/2.2/mod/quickreference.html
# Modified on: <$mt:Date format="%Y.%m.%d"$>

<mt:Ignore># Better website experience for IE users</mt:Ignore>
<IfModule mod_headers.c>
	Header set X-UA-Compatible "IE=Edge,chrome=1"
	<FilesMatch "\.(appcache|crx|css|eot|gif|htc|ico|jpe?g|js|m4a|m4v|manifest|mp4|oex|oga|ogg|ogv|otf|pdf|png|safariextz|svg|svgz|ttf|vcf|webm|webp|woff|xml|xpi)$">
	Header unset X-UA-Compatible
	</FilesMatch>
</IfModule>

<mt:Ignore># Allow access from all domains for webfonts.</mt:Ignore>
<IfModule mod_headers.c>
	<FilesMatch "\.(eot|font.css|otf|ttc|ttf|woff)$">
	Header set Access-Control-Allow-Origin "*"
	</FilesMatch>
</IfModule>

<mt:Ignore># Expires headers (for better cache control)</mt:Ignore>
<IfModule mod_expires.c>
	ExpiresActive on
<mt:Ignore># Perhaps better to whitelist expires rules? Perhaps.</mt:Ignore>
	ExpiresDefault															"access plus 1 month"
<mt:Ignore># cache.appcache needs re-requests in FF 3.6 (thanks Remy ~Introducing HTML5)</mt:Ignore>
	ExpiresByType text/cache-manifest						"access plus 0 seconds"
<mt:Ignore># Your document html</mt:Ignore>
	ExpiresByType text/html											"access plus 1 hour"
<mt:Ignore># Data</mt:Ignore>
	ExpiresByType application/json							"access plus 0 seconds"
	ExpiresByType application/xml								"access plus 0 seconds"
	ExpiresByType text/xml											"access plus 0 seconds"
<mt:Ignore># Feed</mt:Ignore>
	ExpiresByType application/atom+xml					"access plus 1 hour"
	ExpiresByType application/rss+xml						"access plus 1 hour"
<mt:Ignore># Favicon (cannot be renamed)</mt:Ignore>
	ExpiresByType image/x-icon									"access plus 1 week"
<mt:Ignore># Media: images, video, audio</mt:Ignore>
	ExpiresByType audio/ogg											"access plus 1 month"
	ExpiresByType image/gif											"access plus 1 month"
	ExpiresByType image/jpeg										"access plus 1 month"
	ExpiresByType image/png											"access plus 1 month"
	ExpiresByType video/mp4											"access plus 1 month"
	ExpiresByType video/ogg											"access plus 1 month"
	ExpiresByType video/webm										"access plus 1 month"
<mt:Ignore># HTC files	(css3pie)</mt:Ignore>
	ExpiresByType text/x-component							"access plus 1 month"
<mt:Ignore># Webfonts</mt:Ignore>
	ExpiresByType application/vnd.ms-fontobject "access plus 1 month"
	ExpiresByType application/x-font-ttf				"access plus 1 month"
	ExpiresByType application/x-font-woff				"access plus 1 month"
	ExpiresByType font/opentype									"access plus 1 month"
	ExpiresByType image/svg+xml									"access plus 1 month"
<mt:Ignore># CSS and JavaScript</mt:Ignore>
	ExpiresByType application/javascript				"access plus 1 week"
	ExpiresByType text/css											"access plus 1 week"
</IfModule>

<mt:Ignore># Start rewrite engine</mt:Ignore>
<IfModule mod_rewrite.c>
	Options +FollowSymlinks
	RewriteEngine On
	RewriteBase /home/aino/public_html/canasto
</IfModule>

<mt:Ignore># Disable directory browsing</mt:Ignore>
<IfModule mod_autoindex.c>
	Options -Indexes
</IfModule>

<IfModule mod_rewrite.c>
<mt:Ignore>#Redirect requests for www.canasto.es to canasto.es</mt:Ignore>
	RewriteCond %{HTTPS} !=on
	RewriteCond %{HTTP_HOST} ^www\.(.+)$ [NC]
	RewriteRule ^ http://%1%{REQUEST_URI} [R=permanent,L]

<mt:Ignore># Redirect requests for canasto.ai-no.com</mt:Ignore>
	RewriteCond %{HTTP_HOST} ^(www\.)?canasto\.ai\-no\.com [NC]
	RewriteRule ^(.*) http://canasto.es/ [L,R=permanent]

<mt:Ignore># Old files are gone â€“ nothing is permanent</mt:Ignore>
	RewriteRule ^acerca\-de\/ /acerca-de-el-canasto/ [R=permanent,L]
	RewriteRule ^archivos\/ - [G,L]
	RewriteRule ^assets\/2minutos\.png$ /assets/2minutos.jpg [R=permanent,L]
	RewriteRule ^assets\/2minutos\-portable\.png$ /assets/2minutos.jpg [R=permanent,L]
	RewriteRule ^atom\.xml$ http://feeds.canasto.es/canasto [R=permanent,L]
	RewriteRule ^comentarios\.xml http://feeds.canasto.es/canasto-comentarios [R=permanent,L]
	RewriteRule feed(\/)?$ http://feeds.canasto.es/canasto [R=permanent,L]
	RewriteRule ^gtd\/ - [G,L]
	RewriteRule ^organizateconeficacia\/ - [G,L]
	RewriteRule ^productividad\.xml /feed/productividad.xml [R=permanent,L]
	RewriteRule ^servicios\/curso\-presencial\-de\-productividad\-personal\/ - [G,L]
	RewriteRule ^site\/atom$ http://feeds.canasto.es/canasto [R=permanent,L]
	RewriteRule ^site\/ - [G,L]
	RewriteRule ^software\/(blackberry|internet|iphone|linux|osx|palmos|windows|windows\-mobile) - [G,L]
	RewriteRule ^wp-content\/uploads - [G,L]
	RewriteRule ^(.*)/index.(php|html) /$1/ [R=permanent,L]

<mt:Ignore># Redirect feed request to FeedPress</mt:Ignore>
	RewriteCond %{HTTP_USER_AGENT} !(FeedBurner|FeedValidator|uri\.lv|FeedPress) [NC]
	RewriteRule ^feed\/index\.xml$ http://feeds.canasto.es/canasto [R=permanent,L]
	RewriteCond %{HTTP_USER_AGENT} !(FeedBurner|FeedValidator|uri\.lv|FeedPress) [NC]
	RewriteRule ^feed\/comentarios\.xml$ http://feeds.canasto.es/canasto-comentarios [R=permanent,L]
	RewriteCond %{HTTP_USER_AGENT} !(FeedBurner|FeedValidator|uri\.lv|FeedPress) [NC]
	RewriteRule ^2-minutos-productividad\/index\.xml$ http://feeds.canasto.es/2minutos [R=permanent,L]
	RewriteCond %{REQUEST_FILENAME} !-f
	RewriteRule ^(.*)/index.xml http://feeds.canasto.es/canasto [R=permanent,L]
</IfModule>

<mt:Ignore># Special redirects</mt:Ignore>
	RewriteRule ^pago https://spacebox.io/s/R9o1fxc36A [L]

<mt:Ignore># Compress static data</mt:Ignore>
<IfModule mod_deflate.c>
	<mt:Ignore># Force deflate for mangled headers http://developer.yahoo.com/blogs/ydn/posts/2010/12/pushing-beyond-gzipping/ </mt:Ignore>
	<IfModule mod_setenvif.c>
		<IfModule mod_headers.c>
			SetEnvIfNoCase ^(Accept-EncodXng|X-cept-Encoding|X{15}|~{15}|-{15})$ ^((gzip|deflate)\s*,?\s*)+|[X~-]{4,13}$ HAVE_Accept-Encoding
			RequestHeader append Accept-Encoding "gzip,deflate" env=HAVE_Accept-Encoding
		</IfModule>
	</IfModule>
<mt:Ignore># Compress all output labeled with one of the following MIME-types</mt:Ignore>
	<IfModule mod_filter.c>
		AddOutputFilterByType DEFLATE application/atom+xml \
																	application/javascript \
																	application/json \
																	application/rss+xml \
																	application/vnd.ms-fontobject \
																	application/x-font-ttf \
																	application/xhtml+xml \
																	application/xml \
																	font/opentype \
																	image/svg+xml \
																	image/x-icon \
																	text/css \
																	text/html \
																	text/plain \
																	text/x-component \
																	text/xml
	</IfModule>
</IfModule>

<mt:Ignore># Error documents</mt:Ignore>
ErrorDocument 400 /error/400/
ErrorDocument 401 /error/401/
ErrorDocument 403 /error/403/
ErrorDocument 404 /error/404/
ErrorDocument 410 /error/410/
ErrorDocument 500 /error/500/
ErrorDocument 503 /mantenimiento.html

<mt:Ignore># UTF-8 encoding</mt:Ignore>
AddDefaultCharset utf-8
AddCharset utf-8 .atom .css .js .json .rss .vtt .xml

<mt:Ignore># Block access to "hidden" directories or files</mt:Ignore>
<IfModule mod_rewrite.c>
	RewriteCond %{SCRIPT_FILENAME} -d [OR]
	RewriteCond %{SCRIPT_FILENAME} -f
	RewriteRule "(^|/)\." - [F]
</IfModule>

<mt:Ignore># Maintenance mode on/off
<IfModule mod_rewrite.c>
	RewriteEngine On
	RewriteCond %{REQUEST_URI} !^/mantenimiento.html$
	RewriteCond %{REQUEST_URI} !^/assets/mantenimiento.jpg$
	RewriteCond %{REMOTE_HOST} !^85\.58\.55\.164
	RewriteRule .* - [R=503,L]
	<IfModule mod_headers.c>
		Header set Retry-After: 3600
	</IfModule>
</IfModule>
</mt:Ignore>
